{#
 # Helios Theme Macros
 #
 # Reusable template macros for common patterns
 #}

{#
 # Render navigation items recursively
 #
 # @param items array Navigation items
 # @param level int Current nesting level
 #}
{% macro nav_items(items, level) %}
    {% for item in items %}
        <div class="nav-item" x-data="{ expanded: {{ item.active or item.parent_active ? 'true' : 'false' }} }">
            {% if item.children|length > 0 %}
                <button @click="expanded = !expanded"
                        class="nav-link w-full justify-between {{ item.active ? 'active' : '' }}">
                    <span class="flex items-center gap-2">
                        {% if item.api.method is defined %}
                            <span class="api-method method-{{ item.api.method|lower }}">{{ item.api.method }}</span>
                        {% endif %}
                        {{ item.title }}
                    </span>
                    <svg class="nav-toggle" :class="{ 'expanded': expanded }" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                </button>
                <div x-show="expanded" x-collapse class="nav-children">
                    {{ _self.nav_items(item.children, level + 1) }}
                </div>
            {% else %}
                <a href="{{ item.url }}" class="nav-link {{ item.active ? 'active' : '' }}">
                    {% if item.api.method is defined %}
                        <span class="api-method method-{{ item.api.method|lower }}">{{ item.api.method }}</span>
                    {% endif %}
                    {{ item.title }}
                </a>
            {% endif %}
        </div>
    {% endfor %}
{% endmacro %}

{#
 # Render a badge/pill
 #
 # @param text string Badge text
 # @param type string Badge type (default, primary, success, warning, danger)
 #}
{% macro badge(text, type) %}
{% set classes = {
    'default': 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300',
    'primary': 'bg-primary/10 text-primary',
    'success': 'bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300',
    'warning': 'bg-amber-100 text-amber-800 dark:bg-amber-900/50 dark:text-amber-300',
    'danger': 'bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300'
} %}
<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium {{ classes[type|default('default')] }}">
    {{ text }}
</span>
{% endmacro %}

{#
 # Render an icon
 #
 # @param name string Icon name (from svg-icons)
 # @param class string Additional CSS classes
 #}
{% macro icon(name, class) %}
{% set icon_class = class|default('w-5 h-5') %}
{% include 'svg-icons/' ~ name ~ '.svg' with { class: icon_class } ignore missing %}
{% endmacro %}

{#
 # Render a link with external detection
 #
 # @param url string URL to link to
 # @param text string Link text
 # @param class string Additional CSS classes
 #}
{% macro link(url, text, class) %}
{% set is_external = url starts with 'http' and url is not same as (base_url ~ url) %}
<a href="{{ url }}"
   {% if is_external %}target="_blank" rel="noopener noreferrer"{% endif %}
   class="{{ class|default('text-primary hover:underline') }}">
    {{ text }}
    {% if is_external %}
    <svg class="inline-block w-3 h-3 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
    </svg>
    {% endif %}
</a>
{% endmacro %}
